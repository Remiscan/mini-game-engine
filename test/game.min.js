import*as GEM from"../game-engine.js";const start=async function(){this.state.jumpFrames=0,this.state.startTime=performance.now(),this.addActions({jump:["Space"]});const t=this.addLevel({id:"test0"});t.addImage("boole","assets/boole1.png"),t.addSound("bump","assets/ouch.mp3"),t.addObject({width:this.width,height:this.height,draw:function(t){t.fillStyle="black",t.fillRect(0,0,this.width,this.height)}}),t.addObject({id:"rect",width:32,height:32,position:{x:64,y:64},collision:!0,draw:function(t){this.allCollisions().length>0?t.fillStyle="red":t.fillStyle="blue",t.fillRect(this.position.x,this.position.y,this.width,this.height)}}),t.addObject({id:"player",width:32,height:32,position:{x:32,y:128},maxSpeed:5,controllable:!0,collision:!0,assets:["boole"],draw:function(t,{x:e,y:s,game:i}){const a=this.assets.find((t=>"boole"===t.id)).data;t.imageSmoothingEnabled=!1,this.angle>-Math.PI/2&&this.angle<Math.PI/2?(t.translate(i.width,0),t.scale(-1,1),t.drawImage(a,i.width-e,s,-this.width,this.height)):t.drawImage(a,e,s,this.width,this.height)}}),await this.loadLevel("test0")},update=function(t){const e=performance.now();this.state.actions.includes("jump")?this.state.jumpFrames++:this.state.jumpFrames>0&&(this.state.jumpFrames=0);const s=this.state.level.objects.filter((t=>t.controllable));for(const e of s){const s=Object.assign({},e.position),i={x:(-this.state.actions.includes("left")+this.state.actions.includes("right"))*t,y:(-this.state.actions.includes("up")+this.state.actions.includes("down"))*t};if(0===i.x&&0===i.y)continue;const a=e.moveByVector(i);0===i.x&&0===i.y||a.x!==s.x||a.y!==s.y?e.state.bumped=!1:(e.state.bumped||this.playSound("bump"),e.state.bumped=!0)}this.state.startTime=e},game=new GEM.Game(start,update,{tickRate:60}),buttonPlay=document.querySelector(".load-game");buttonPlay.addEventListener("click",(()=>{buttonPlay.remove(),game.play()}));const buttonPause=document.querySelector(".pause-game");buttonPause.addEventListener("click",(()=>game.paused=!game.paused));